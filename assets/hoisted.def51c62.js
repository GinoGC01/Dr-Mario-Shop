let t=localStorage.getItem("productos-en-carrito");t=JSON.parse(t);const u=document.querySelector("#carrito-vacio"),s=document.querySelector("#carrito-productos"),g=document.querySelector("#carrito-acciones"),B=document.querySelector("#form-compra");document.querySelector("#mensaje-compra");const h=document.querySelector("#numero-articulos"),P=document.querySelector(".carrito-acciones-vaciar"),O=document.querySelector("#precio-total"),T=document.querySelector(".generar-orden"),l=document.querySelector("#form-compra"),k=document.querySelector("#input-productos-form"),A=document.querySelector("#generador-orden"),I=document.querySelector(".id-orden"),b=document.querySelector(".main");let y=document.querySelectorAll(".carrito-producto-eliminar");function v(){s.innerHTML="",t&&t.length>0?(u.classList.add("disabled"),s.classList.remove("disabled"),g.classList.remove("disabled"),t.forEach(e=>{const o=document.createElement("div");o.classList.add("card__carrito-producto"),o.innerHTML=`
                        <img src="${e.img.image01}" alt="${e.nombre}" class="carrito-producto-imagen">
                        <div class="carrito-producto crr-titulo">
                            <small>Producto:</small>
                            <h3>${e.nombre}</h3>
                        </div>
                        <div class="carrito-producto crr-talle">
                            <small>Talle:</small>
                            <h3>${e.talle.talle}</h3>
                        </div>
                        <div class="carrito-producto crr-cantidad">
                            <small>Cantidad:</small>
                            <p>${e.cantidad}</p>
                        </div>
                        <div class="carrito-producto crr-precio">
                            <small>Precio:</small>
                            <p>$${e.precio}</p>
                        </div>
                        <div class="carrito-producto crr-total">
                            <small>Subtotal:</small>
                            <p>$${e.precio*e.cantidad}</p>
                        </div>
                        <button class="carrito-producto-eliminar" id="${e.id}">
                            <span class="material-symbols-outlined">delete_forever</span>
                        </button>
            `,s.append(o),C()})):(u.classList.remove("disabled"),s.classList.remove("disabled"),g.classList.add("disabled")),M(),z()}v();function S(){t.length>0?(u.classList.add("disabled"),b.classList.remove("carrito-vacio")):b.classList.add("carrito-vacio")}S();function C(){if(t&&t.length>0){let e=t.reduce((o,r)=>o+r.cantidad,0);h.innerText=e}else if(t.length===0){let e=t.length;h.innerText=e}}function M(){y=document.querySelectorAll(".carrito-producto-eliminar"),y.forEach(e=>{e.addEventListener("click",N)})}function N(e){Toastify({text:"Producto eliminado :(",duration:2500,newWindow:!0,close:!1,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #0c0c0c, #0c0c0c)",textTransform:"uppercase",fontSize:".75em"},offset:{x:"2em",y:"2em"},onClick:function(){}}).showToast();const o=e.currentTarget.id,r=t.findIndex(a=>a.id===o);t[r].cantidad--,t[r].cantidad<=0&&t.splice(r,1),v(),C(),S(),m(),m(),localStorage.setItem("productos-en-carrito",JSON.stringify(t))}P.addEventListener("click",w);function $(){t.length=0,localStorage.setItem("productos-en-carrito",JSON.stringify(t)),v(),C(),q(),S()}function w(){Swal.fire({title:"Vaciar Carrito",text:"Se eliminarán todos los productos del carrito",icon:"info",showCancelButton:!0,confirmButtonColor:"#0c0c0c",cancelButtonColor:"#0c0c0c",cancelButtonText:"Cancelar",confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&$()})}function z(){const e=t.reduce((o,r)=>o+r.cantidad*r.precio,0);O.innerText=`$${e}`}const L=document.querySelector("#input-productos-form-ID"),D=document.querySelector(".span-aviso-1");T.addEventListener("click",V);function F(e){const o="ABCDEFGHIJKLMNÑOPQRSTUVWXYZ",r=o.length;let a="";for(let c=0;c<e;c++)a+=o.charAt(Math.floor(Math.random()*r));return a}function H(){let e=Math.floor(Math.random()*1e3),o=F(4),r=e+"-"+o,a=r.toString();I.innerText=a,D.innerText=a,L.value=r,console.log(L.value)}function q(){t.length>0?l.classList.remove("form-disabled"):l.classList.add("form-disabled"),T.setAttribute("disabled","true")}function V(){q(),H()}function m(){const e=t.reduce((a,c)=>a+c.cantidad*c.precio,0),r=`(${t.map(({nombre:a,cantidad:c,talle:d,id:n,precio:i})=>{let E=d.talle;return`Producto N° ${n} = (Nombre: ${a}, Cantidad: ${c}, Talle: ${E}, Precio: $${i}, Precio Total: $${i*c})`})}) Precio total de la orden ==> $${e}`;k.value=r}m();function J(e){e.preventDefault(),Swal.fire({title:"Orden de compra",text:"Al generar la orden de compra acepto los términos y condiciones de compra",icon:"info",showCancelButton:!0,confirmButtonColor:"#0c0c0c",cancelButtonColor:"#0c0c0c",cancelButtonText:"Cancelar",confirmButtonText:"Ok"}).then(o=>{if(o.isConfirmed){const r=l.nombre.value,a=l.email.value,c=l.numberPhone.value,d="Completa el formulario de Orden de compra.",n=i=>!i||i.trim()==="";n(r)||n(a)||n(c)?alert(d):/\S+@\S+\.\S+/.test(a)?(B.submit(),$()):alert("Dirección de correo electrónico inválida.")}})}A.addEventListener("click",J);const f=document.querySelector(".menu"),x=document.querySelector(".aside"),p=document.querySelector(".close");f.addEventListener("click",()=>{x.classList.add("aside-on"),f.classList.add("hamb-off"),p.classList.add("close-on")});p.addEventListener("click",()=>{x.classList.remove("aside-on"),f.classList.remove("hamb-off"),p.classList.remove("close-on")});
